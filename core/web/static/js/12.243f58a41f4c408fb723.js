webpackJsonp([12],{"0HMi":function(t,e){},zk1L:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=[{title:"类型",dataIndex:"type",key:"type",scopedSlots:{customRender:"type"}},{title:"分类名称",dataIndex:"name",key:"name",scopedSlots:{customRender:"name"}},{title:"更新时间",key:"update_time",dataIndex:"update_time",scopedSlots:{customRender:"update_time"}},{title:"创建时间",key:"create_time",dataIndex:"create_time",scopedSlots:{customRender:"create_time"}},{title:"操作",key:"action",scopedSlots:{customRender:"action"},width:60}],s={name:"classificationHome",data:function(){return{columns:o,loading:!1,data:[],formAdd:this.$form.createForm(this),visible_add:!1,formUpdate:this.$form.createForm(this),visible_edit:!1,key:0,loadingUpdate:!1,loadingAdd:!1,so_text:"",select_type:0}},mounted:function(){this.onLoad()},methods:{onLoad:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.loading=!0,this.$http.post("/api/v1/w5/get/type/list",{type:a,keywords:e}).then(function(e){0==e.code?(t.data=e.data,t.loading=!1):(t.$message.error(e.msg),t.loading=!1)})},del:function(t,e){var a=this;this.$http.post("/api/v1/w5/post/type/del",{id:t,type:e}).then(function(t){0==t.code?(a.$message.success("删除成功"),a.onLoad()):a.$message.error(t.msg)})},onAdd:function(t){var e=this;t.preventDefault(),this.formAdd.validateFields(function(t,a){t||(e.loadingAdd=!0,e.$http.post("/api/v1/w5/post/type/add",{type:a.type,name:a.name}).then(function(t){0==t.code?(e.$message.success("添加成功"),e.loadingAdd=!1,e.onCloseAdd(),e.onLoad()):(e.$message.error(t.msg),e.loadingAdd=!1)}))})},onUpdate:function(t){var e=this;t.preventDefault(),this.formUpdate.validateFields(function(t,a){t||(e.loadingUpdate=!0,e.$http.post("/api/v1/w5/post/type/update",{id:e.key,type:a.type,name:a.name}).then(function(t){0==t.code?(e.$message.success("更新成功"),e.loadingUpdate=!1,e.onCloseEdit(),e.onLoad()):(e.$message.error(t.msg),e.loadingUpdate=!1)}))})},showEdit:function(t,e,a){var o=this;setTimeout(function(){o.formUpdate.setFieldsValue({type:String(e),name:a})},100),this.key=t,this.visible_edit=!0},onCloseEdit:function(){this.visible_edit=!1},showAdd:function(){var t=this;setTimeout(function(){t.formAdd.setFieldsValue({name:""})},100),this.visible_add=!0},onCloseAdd:function(){this.visible_add=!1},onSearch:function(t){this.so_text=t,this.onLoad(this.so_text,this.select_type)},onSelect:function(t){this.select_type=t,this.onLoad(this.so_text,this.select_type)},onFilterOption:function(t,e){return e.componentOptions.children[0].text.toLowerCase().indexOf(t.toLowerCase())>=0}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-layout-content",[a("div",{staticClass:"header_div"},[a("a-select",{staticClass:"align",staticStyle:{width:"120px"},attrs:{"show-search":"","filter-option":t.onFilterOption,"default-value":"0"},on:{change:t.onSelect}},[a("a-select-option",{attrs:{value:"0"}},[t._v("全部")]),t._v(" "),a("a-select-option",{attrs:{value:"1"}},[t._v("剧本分类")]),t._v(" "),a("a-select-option",{attrs:{value:"2"}},[t._v("变量分类")])],1),t._v(" "),a("a-input-search",{staticClass:"align",staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},on:{search:t.onSearch}}),t._v(" "),a("a-button",{staticClass:"align btn_add",attrs:{type:"primary",icon:"plus-circle"},on:{click:t.showAdd}},[t._v("\n            添加\n        ")])],1),t._v(" "),a("a-table",{attrs:{rowKey:"id",columns:t.columns,"data-source":t.data,loading:t.loading},scopedSlots:t._u([{key:"name",fn:function(e){return a("span",{},[a("b",[t._v(t._s(e))])])}},{key:"type",fn:function(e){return a("a-tag",{attrs:{color:"#7d838c"}},[1==e?a("b",[t._v("剧本分类")]):2==e?a("b",[t._v("变量分类")]):t._e()])}},{key:"update_time",fn:function(e){return a("span",{},[t._v("\n            "+t._s(t.Dayjs(e).subtract(8,"hour").format("YYYY-MM-DD HH:mm:ss"))+"\n        ")])}},{key:"create_time",fn:function(e){return a("span",{},[t._v("\n            "+t._s(t.Dayjs(e).subtract(8,"hour").format("YYYY-MM-DD HH:mm:ss"))+"\n        ")])}},{key:"action",fn:function(e,o){return a("span",{},[a("a-space",{attrs:{size:"small"}},[a("a-tooltip",{attrs:{placement:"left"}},[a("template",{slot:"title"},[a("span",[t._v("删除")])]),t._v(" "),a("a-popconfirm",{attrs:{title:"是否要删除该分类?","ok-text":"是","cancel-text":"否"},on:{confirm:function(e){return t.del(o.id,o.type)}}},[a("a-icon",{staticClass:"pointer",attrs:{type:"delete"}})],1)],2),t._v(" "),a("span",[t._v("|")]),t._v(" "),a("a-tooltip",{attrs:{placement:"top"}},[a("template",{slot:"title"},[a("span",[t._v("编辑")])]),t._v(" "),a("a-icon",{staticClass:"pointer",attrs:{type:"form"},on:{click:function(e){return t.showEdit(o.id,o.type,o.name)}}})],2)],1)],1)}}])}),t._v(" "),a("a-drawer",{attrs:{title:"添加新分类",width:300,visible:t.visible_add,"body-style":{paddingBottom:"80px"}},on:{close:t.onCloseAdd}},[a("a-form",{attrs:{form:t.formAdd,layout:"vertical"},on:{submit:t.onAdd}},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"分类类型"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["type",{rules:[{required:!0,message:"请选择分类类型"}]}],expression:"[\n                  'type',\n                  {\n                    rules: [{ required: true, message: '请选择分类类型' }],\n                  },\n                ]"}],attrs:{"show-search":"","filter-option":t.onFilterOption,placeholder:"请选择分类类型"}},[a("a-select-option",{attrs:{value:"1"}},[t._v("剧本分类")]),t._v(" "),a("a-select-option",{attrs:{value:"2"}},[t._v("变量分类")])],1)],1)],1),t._v(" "),a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"分类名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入分类名称"},{max:20,message:"分类名称长度不能超过20位"}]}],expression:"[\n                  'name',\n                  {\n                    rules: [\n                      { required: true, message: '请输入分类名称' },\n                      { max: 20, message: '分类名称长度不能超过20位' },\n                    ],\n                  },\n                ]"}],attrs:{placeholder:"请输入分类名称"}})],1)],1)],1),t._v(" "),a("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:1}},[a("a-button",{style:{marginRight:"8px"},on:{click:t.onCloseAdd}},[t._v("关闭")]),t._v(" "),a("a-button",{attrs:{type:"primary","html-type":"submit",loading:t.loadingAdd}},[t._v("\n                    添加\n                ")])],1)],1)],1),t._v(" "),a("a-drawer",{attrs:{title:"更新分类信息",width:300,visible:t.visible_edit,"body-style":{paddingBottom:"80px"}},on:{close:t.onCloseEdit}},[a("a-form",{attrs:{form:t.formUpdate,layout:"vertical"},on:{submit:t.onUpdate}},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"分类类型"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["type",{rules:[{required:!0,message:"请选择分类类型"}]}],expression:"[\n                  'type',\n                  {\n                    rules: [{ required: true, message: '请选择分类类型' }],\n                  },\n                ]"}],attrs:{"show-search":"","filter-option":t.onFilterOption,placeholder:"请选择分类类型"}},[a("a-select-option",{attrs:{value:"1"}},[t._v("剧本分类")]),t._v(" "),a("a-select-option",{attrs:{value:"2"}},[t._v("变量分类")])],1)],1)],1),t._v(" "),a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"分类名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入分类名称"},{max:20,message:"分类名称长度不能超过20位"}]}],expression:"[\n                  'name',\n                  {\n                    rules: [\n                      { required: true, message: '请输入分类名称' },\n                      { max: 20, message: '分类名称长度不能超过20位' },\n                    ],\n                  },\n                ]"}],attrs:{placeholder:"请输入分类名称"}})],1)],1)],1),t._v(" "),a("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:1}},[a("a-button",{style:{marginRight:"8px"},on:{click:t.onCloseEdit}},[t._v("关闭")]),t._v(" "),a("a-button",{attrs:{type:"primary","html-type":"submit",loading:t.loadingUpdate}},[t._v("\n                    更新\n                ")])],1)],1)],1)],1)},staticRenderFns:[]};var i=a("Mz/3")(s,n,!1,function(t){a("0HMi")},"data-v-4d17664c",null);e.default=i.exports}});